<header>
	{{ $currentPage := . }}
	{{ $currentYear := index (split .RelPermalink "/") 1 }}
	
	<div class="top-content">
	  <div class="logo">
			{{ $logoPath := "" }}
			{{ if $currentYear }}
				{{ $logoPath = (index .Site.Params $currentYear).logos.header }}
			{{ else }}
				{{ $logoPath = (index .Site.Params "2024").logos.header }}
			{{ end }}		
			<a href="{{ printf "/%s/" $currentYear | relLangURL }}">
     	   <img src="{{ $logoPath }}" alt="logo {{ .Site.Title }}">
		</a>
	  </div>
  
	  <input type="checkbox" id="menu-burger" class="visually-hidden" aria-label="Menu"/>
	  <label for="menu-burger">
		{{ partial "icon.html" "menu" }}
		{{ partial "icon.html" "close" }}
	  </label>

	<nav>
	  <ul class="menu"></ul>
		{{ $yearMenu := index .Site.Menus $currentYear }}
		{{ range $yearMenu }}
			{{ if .HasChildren }}
				<li class="has-children {{ if $currentPage.IsMenuCurrent $currentYear . }}active{{ end }}">
				<!-- make the parent menu item not clickable -->
				<a>{{ .Name }}</a> 
				<ul class="submenu">
					{{ range .Children }}
					<li class="{{ if $currentPage.IsMenuCurrent $currentYear . }}active{{ end }}">
						<a href="{{ .URL | relLangURL }}">{{ .Name }}</a>
					</li>
					{{ end }}
				</ul>
				</li>
			{{ else }} <!-- no children -->
			<li class="{{ if $currentPage.IsMenuCurrent $currentYear . }}active{{ end }}">
				<a href="{{ .URL | relLangURL }}">{{ .Name }}</a>
			</li>
			{{ end }}
		{{ end }}
	  </ul>
	</nav>
	</div>
</header>

{{ define "scripts" }}
<script>
  document.addEventListener('DOMContentLoaded', function() {
	const menuItems = document.querySelectorAll('.has-children > a');
	
	menuItems.forEach(item => {
	  item.addEventListener('click', function(e) {
		if (window.innerWidth < 1200) {  // xl breakpoint
		  e.preventDefault();
		  const parent = this.parentElement;
		  parent.classList.toggle('active');
		  
		  // Close other open submenus
		  menuItems.forEach(other => {
			if (other !== this) {
			  other.parentElement.classList.remove('active');
			}
		  });
		}
	  });
	});
  
	// Close submenus when clicking outside
	document.addEventListener('click', function(e) {
	  if (!e.target.closest('nav')) {
		menuItems.forEach(item => {
		  item.parentElement.classList.remove('active');
		});
	  }
	});
  });
</script>
{{ end }}