{{ $currentYear := string .Site.Params.currentYear }}
{{ if not (eq .Section "") }}
  {{ $currentYear = .Section }}
{{ end }}

<!DOCTYPE html>
<html lang="{{ $.Site.LanguageCode | default " en" }}">
{{ partial "head.html" . }}

<body class="{{ .Kind }} 
	{{ with .Type }}{{ . }}{{ end }}
    {{- $urlParts := split (strings.TrimPrefix "/" .RelPermalink) "/" -}}
    {{ if ge (len $urlParts) 2 }}
        {{ index $urlParts 1 }}
        {{ index $urlParts 0 }}
    {{- end -}}
">


<!-- Debug Info (only visible in development) -->
{{ if hugo.IsProduction | not }}
  <div style="background: #f0f0f0; padding: 10px; margin: 10px; font-family: monospace; font-size: 12px;">
    <details>
      <summary>Debug Info from _default/baseof.html </summary>
      <pre>
  Page Kind: {{ .Kind }}
  RelPermalink: {{ .RelPermalink }}
  Anchorized RelPermalink: {{ anchorize .RelPermalink }}
  Section: {{ .Section }}
  Section Type: {{ printf "%T" .Section }}
  Section Type: {{ len .Section }}
  Section empty? {{ eq .Section "" }}
  Type: {{ .Type }}
  Layout: {{ .Layout }}
  Current Section: {{ .CurrentSection }}
  Parent Section: {{ .CurrentSection.Parent }}
  Params.currentYear: {{ .Site.Params.currentYear }}
  Current Year: {{ $currentYear }}
      </pre>
    </details>
  </div>
{{ end }}

{{ readFile "themes/devfest-theme-hugo/static/icons.svg" | safeHTML }}

{{ block "header" . }}
{{ partial "header.html" . }}
{{ end }}

<main>
  {{ block "banner" . }}
    {{ $currentYear := string .Site.Params.currentYear }}
    {{ if not (eq .Section "") }}
      {{ $currentYear = .Section }}
    {{ end }}

    <div class="banner">
      {{ $logoPath := (index .Site.Params $currentYear).logos.banner }}
      <img id="banner-img" src="{{ $logoPath }}" alt="logo {{ .Site.Title }} ">
    </div>
  {{ end }}

	{{ block "main" . }}
	<!-- Missing main block -->
	{{ end }}
</main>

{{ block "footer.html" . }}
{{ partial "footer.html" . }}
{{ end }}

<script src="/theme.js" async></script>
{{ block "scripts" . }}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const menuItems = document.querySelectorAll('.has-children > a');
  
  menuItems.forEach(item => {
    item.addEventListener('click', function(e) {
      if (window.innerWidth < 1200) {  // xl breakpoint
        e.preventDefault();
        const parent = this.parentElement;
        parent.classList.toggle('active');
        
        // Close other open submenus
        menuItems.forEach(other => {
          if (other !== this) {
            other.parentElement.classList.remove('active');
          }
        });
      }
    });
  });

  // Close submenus when clicking outside
  document.addEventListener('click', function(e) {
    if (!e.target.closest('nav')) {
      menuItems.forEach(item => {
        item.parentElement.classList.remove('active');
      });
    }
  });
});
  </script>
{{ end }}
</body>

</html>
